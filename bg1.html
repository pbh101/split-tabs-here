<html>
<head>
<script>

targetWindowId = undefined;
sourceWindowId = undefined;
currentTabId = undefined;
  
  function onGetCurrentTab(currentTab){
    currentTabId = currentTab.id;
    
  }
  
  function onGetCurrentWindow(sourceWindow){
    sourceWindowId = sourceWindow.id;
    chrome.tabs.getCurrent(onGetCurrentTab);
  }
  
  function onWindowCreated(targetWindow){
    targetWindowId = targetWindow.id;
    chrome.windows.getCurrent(onGetCurrentWindow);
  }
  
  function createWindow(){
    //chrome.tabs.getCurrent(function callback)
    //chrome.windows.create()
    chrome.windows.create({}, onWindowCreated);
  }
  
  chrome.browserAction.onClicked.addListener(createWindow);
</script>
</head>
</html>